---
marp: true
theme: "soc"
header: "Wed, June 18"
paginate: true
size: 16:9
math: katex
---

<!-- class: lead -->

# Chapter-06 セキュリティオペレーション
###
#### 5J 05 f21012 岩﨑大輝

---

<!-- header: "" -->
<!-- class: contents -->

## 目次

1.  セキュリティオペレーション / SOC とは
       - SOCの構成要素、SOCメンバーの役割分担
       - アラート、セキュリティイベント
2.  セキュリティオペレーションの基本プロセス
       - ログの収集、検知、影響評価
       - インシデントへの対応要否の決定、報告と連携
3.  セキュリティオペレーションの定期レポートと維持改善
       - 定期レポート、維持改善
4.  監視・分析用のセキュリティツールと監視技術
       - EDR、NDR、SOAR、ゼロトラストネットワーク監視

---

## 1. セキュリティオペレーション / SOCとは
SOC(Security Operation Center)は、ネットワークや情報システムのセキュリティ機器を監視し、潜在的な脅威やサイバー攻撃を検知して対応する。

<!-- NOCとの違いについても言及する? -->

主な業務
- セキュリティイベントのリアルタイム監視
- ログの分析
- マルウェアやサイバー攻撃などの異常な挙動の検知
- セキュリティインシデントの迅速な対応

→ 早期にセキュリティインシデントを検知して暫定的な対応をする。
  その後、すぐにCSIRTへ連携して被害を最小限に抑える。

---

<!-- header: "1. セキュリティオペレーション / SOCとは" -->
<!-- SOCには、次の2種類がある -->

## プライベートSOCとパブリックSOC/共有SOC

**プライベートSOC**: 自分の組織を監視するためのSOC。自組織で構築し運用するため、環境や要求に合わせて、SOCを柔軟にカスタマイズできる。一方で、
SOCメンバーの教育が必要になり、監視対象の規模が大きいほどコストがかかる。
<span>→ 大規模な組織向け</span>

**パブリックSOC/共有SOC**: セキュリティ企業がまとめて他組織を監視する。セキュリティ企業がSOCを所有し、セキュリティ監視の技術を持ったSOCメンバーを配置して体制を維持する。複数組織をまとめて監視するため、費用対効果が高く、SOCメンバー経験や知識を共有できる。
<span>→ 予算が少なく体制構築が難しい中小企業向け</span>

---

<!-- SOCの業務について図式化したものを以下に示す -->

## SOCの立ち位置

---

<!-- SOCメンバーが利用するツールや情報について紹介 -->
<!-- それぞれの役割や使われ方について明確にする -->

## SOCの構成要素

**SIEM(Security Information and Event Management)**: セキュリティ機器や各種サーバ、クラウドサービスなどからシステムログやメッセージを収集して管理し、ルールを使って分析してサイバー攻撃を発見する。時刻やIPアドレス、FQDN、ユーザIDなどの共通するキーワードを使ってログを関連付け、相関分析を行う。
<span>→ 異常なアクティビティやサイバー攻撃をリアルタイムで検知</span>

**UEBA(User and Entity Behavior Analytics)**: 収集したシステムログやメッセージからエンティティを特定し、これらをもとにログの関連付けを行って振る舞いを分析する。その操作手順や処理フローといった振る舞いはモデル化される。
<span>→ そのモデルから逸脱した異常な操作や処理を検知</span>

<span class="mean">エンティティ: ユーザやネットワーク機器、個人用PC、クラウドサービスなどの実在するもの。</span>

---

## SOCの構成要素

**脆弱性データベース**: 脆弱性の対策方法を調査するときや、サイバー攻撃を検知したときやインシデント対応で詳細調査をする際に使う。
<!-- 例があるといいかも(サイトなど) -->

**IOCデータベース**: IOC(Indicator of Compromise)とは、サイバー攻撃やマルウェア感染の特徴的な攻撃パターンや痕跡、証拠の情報(例: IPアドレスやドメイン名、ファイルのハッシュ値、レジストリ上の文字列など)。これらのIOCを収集・管理している。このデータベースから必要なIOCを取り出して、インシデントの検知や分析に使う。

**脅威情報 / 脅威インテリジェンス(Threat Intelligence)**: サイバー攻撃やマルウェア、不正アクセスなどの攻撃の情報、攻撃者の行動、攻撃の方法(**TTP**: Tactics,Techniques, and Procedures)、攻撃グループの活動の特徴、使用する攻撃方法やツールの情報。インシデントを分析するとき、攻撃者や攻撃方法などを推測するために利用する。

---

## アラート、セキュリティイベント、セキュリティインシデント

<!-- SOCは、下記の情報の単位を取り扱う。 -->

**メッセージ**: NWやセキュリティ、OSなどの機器やプログラムの稼働状況を表す最小単位の情報。

**アラート**: FW、IDS/IPSなどのセキュリティ機器やSIEM、UEBAなどがサイバー攻撃や不審な事象を検知したときに生成するメッセージの一種。

**ログ**: メッセージやアラートを記録したファイル。システムの稼働状況やセキュリティに関する情報を含み、トラブルシューティングやセキュリティ監視・監査などに利用する。

---

## アラート、セキュリティイベント、セキュリティインシデント

**セキュリティイベント**: システムやネットワークで発生したセキュリティに関連する事象の総称。

**セキュリティインシデント**: 組織の情報セキュリティを脅かす出来事(例: セキュリティ違反、サイバー攻撃、データ漏洩など)。セキュリティイベントを分析して、発見したサイバー攻撃や被害が発生したと判定した事象がこれに当たる。

---

## SOCメンバーの役割分担

<!-- 自分の役割で出来ない場合は、違う人に後回しにする -->
監視作業の難易度の順に役割を階層化している。自分の役割で解決できなかった事項は、別の役割が引き継いで解決する連携方式の体制。

**Tier 1**: SIEMをリアルタイムで監視して、セキュリティ機器とセキュリティツールのアラートやSIEMが出力したセキュリティイベントを処理する。

1. セキュリティイベントを分類し、危険度を評価して誤検知を取り除く 。
2. 残ったセキュリティイベントのうち、あらかじめ定義した危険度以上のものを
セキュリティインシデントと判定する。

調査や判定ができなかったセキュリティイベントをTier 2へ申し送って、追加調査や誤検知の判定を委ねる。最近は、SIEMやUEBAがTier 1を自動処理する。

---

## SOCメンバーの役割分担

**Tier 2**: Tier 1から受け取ったセキュリティイベントやセキュリティインシデントを処理する。セキュリティインシデントを分析して、インシデント対応に必要な情報、発生日時や攻撃元・攻撃先、マルウェアの特定、被害の範囲や大きさ、原因、侵入や攻撃の方法、経路などをまとめる。

**セキュリティアナリスト(Security Analyst)**: Tier 1、Tier 2の調査結果を確認し、修正や、調査が不十分な箇所について追加で調査を行い、結果をまとめる。セキュリティインシデントの場合、調査結果を報告様式に記入して、決まった時間内に自組織のCSIRTやクライアントへ報告する。

<br>
→ SOCは、監視対象の検知状況を定期的にまとめレポートを作成し、監視対象のリスクと対応策を考察する。併せて、セキュリティ対策の改善や予防策を提案する。

---

<!-- header: "" -->

## 2. セキュリティオペレーションの基本プロセス

<!-- 一般的なSOCの監視業務の基本プロセスは以下の通りです。 -->

SOCの監視業務の基本プロセス(リスクの検知～インシデント報告)

1. ログの収集や正規化
2. 相関分析
3. 検知
4. アラート/検知結果の判定
5. 影響評価
6. セキュリティインシデントの対応要否の決定
7. セキュリティインシデントの報告と対応連携

---

<!-- header: "2. セキュリティオペレーションの基本プロセス" -->

## 1. 収集や正規化

**ログの収集**: セキュリティ機器やセキュリティツール、監視対象の情報システムやネットワークなどからメッセージやアラート、ログを取集する。収集した情報を正確に分析できるように、セキュリティ機器や情報システムの時刻を正確に合わせておく。インターネット経由で収集する場合は、通信を暗号化して情報の機密性を確保する。

**ログの正規化**: 収集したログは異なる形式や構造であるため、SIEMやUEBAは、構造を解釈して統一的なデータセットに変換する。正規化したログは、SIEMやUEBAで統合管理する。

---

## 2. 相関分析

SIEMやUEBAが収集したログを分析するとき、複数のセキュリティイベント間の関連性を分析する手法。セキュリティイベント群AとBに関係があることを客観的に示す際に使う。

**コリレーション分析**: 数値データを使って異なるセキュリティイベント間の相関係数を計算し、相関の強さは相関係数の絶対値で表す。(0～0.2は相関なし、0.7～1は強い相関あり)

**時系列分析**: 異なる複数のセキュリティイベントを時刻順に並べて解析し、数値の急激な変化や周期性など特徴的な部分を見つける。

**ネットワークフロー分析**: ネットワーク通信のセキュリティイベントを用いて、通信のパターンや送信元と送信先の間の関連などを調査する。通信のシーケンスや成功/失敗の状態、回数を解析する。

---

## 3. 検知

セキュリティ機器やセキュリティツールは、様々な手法を使ってセキュリティイベントを検知する。

**パターンマッチング**: IOCと一致するセキュリティイベントを検知する。
<!-- 単純な方法は、 -->
- IPアドレスやFQDN、URL、HTTPのUserAgentなどの文字列を比較
- 時刻や回数/頻度、地理的な場所などの条件で絞り込む

**アノマリ検知**: 通常の状態と比較して異常な状態のセキュリティイベントを検出する。通常の状態は、RFCや技術者の知見、統計的な方法、機械学習アルゴリズムなどから定義する。異なる状態のセキュリティイベントをすべて検知するため、リスクのない通信も誤検知する。

---

## 3. 検知

**ヒューリスティック手法**: 既知のサイバー攻撃の方法や特徴に基づいて検知ルールや検知パターンを定義して、これらと合致するセキュリティイベントを検出する。類似のサイバー攻撃は検知できるが、未知のサイバー攻撃は検知できない。

**振る舞い検知(Behavioral Analytics)**: ユーザの操作手順やソフトウェアの処理フロー、不正アクセスやサイバー攻撃の処理フローをモデル化する。連続したセキュリティイベントとそのモデルを比較して、セキュリティイベントを検出する。アノマリ検知と同様に、リスクのない振る舞いも検知する。

**機械学習やAIを使った検知**: 機械学習や人工知能を活用した高度な自動検知手法。
例: LSTMを用いたパケット予測に基づくDNS攻撃の異常検知(Satoshi Kimura, Hiroyuki Inaba, "Proposal of Anomaly Detection For DNS Attacks Based on Packets Prediction Using LSTM.")

---

## 4. アラート/検知結果の判定

SOCメンバーは、アノマリ検知や振る舞い検知から得られたアラート/検知結果を確認し、誤検知(False Positive)を取り除く。
<!-- 代表的な誤検知判定の観点や方法を挙げる。 -->

**通信やプロセスを検知した場合**: 前後の通信やプロセスを詳細に調査する。不審なファイルのダウンロードや実行、IOCや脅威情報に該当する不審なサイトへの通信がある場合、サイバー攻撃や不審なセキュリティイベントを検知したと判定する。

**通信経路の途中のセキュリティ機器がサイバー攻撃を検知検知した場合**: 

---

## 4. アラート/検知結果の判定

**サイバー攻撃が標的の機器やソフトウェアへ到達している場合**:

**誤検知する確率の高い検知ルールなどによる検知の場合**:

---

## 5. 影響評価

---

## 6-7. インシデントへの対応

---

<!-- header: "" -->

## 3. セキュリティオペレーションの定期レポートと維持改善

**定期レポート**: インシデントの検知数や誤検知数などを統計分析した結果やインシデントの詳細情報や影響、考察を記載する。また、数値の経時変化からセキュリティリスクの増減も考察する。
<span>→ リスク状況を把握し、緊急対策や維持改善を行う。

**維持改善**: 誤検知数や誤検知の影響が閾値以上の場合は、原因を究明して、検知システムを改善する。検知ルールの設定の調整や、アラート/検知結果の判定方法の修正によって、誤検知を削減する。改善の効果は、定期レポートの統計分析の結果で確認する。

---

## 4. 監視・分析用のセキュリティツールと監視技術

SOCで使用する監視・分析用のセキュリティツールと監視技術

- EDR, NDR, SOAR
- 脅威ハンティング
- ゼロトラストネットワーク監視

---

<!-- header: "4. 監視・分析用のセキュリティツールと監視技術" -->

## EDR(Endpoint Detection and Response)


---

## NDR(Network Detection and Response)


---

## SOAR(Security Orchestration, Automation, and Response)


<!-- 概念図も掲載 -->

---

## 脅威ハンティング(Threat Hunting)


---

## ゼロトラストネットワーク監視

